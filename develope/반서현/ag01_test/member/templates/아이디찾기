let currentMode = "findId"; // 기본값은 아이디 찾기 화면

// 아이디 찾기 메뉴 클릭 시
signin.on("click", function(e) {
    e.preventDefault(); // 페이지 새로고침 방지
    currentMode = "findId"; // 아이디 찾기 화면으로 전환
    resetToFindId(); // 아이디 찾기 화면 설정
});

// 비밀번호 찾기 메뉴 클릭 시
signup.on("click", function(e) {
    e.preventDefault(); // 페이지 새로고침 방지
    currentMode = "findPw"; // 비밀번호 찾기 화면으로 전환
    resetToFindPw(); // 비밀번호 찾기 화면 설정
});

// 현재 화면에 따라 버튼 텍스트, 동작 변경
findBtn.on("click", function() {
    if (currentMode === "findId") { 
        // 아이디 찾기 요청 처리
        handleFindId();
    } else if (currentMode === "findPw") {
        // 비밀번호 찾기 요청 처리
        handleFindPw();
    }
});

// 아이디 찾기 함수
function handleFindId() {
    const name = $("#name").val();
    const email = $("#email").val();

    $.ajax({
        url: "/member/findId/",
        type: "POST",
        headers: { "X-CSRFToken": csrfToken },
        data: { name, email },
        success: function(response) {
            if (response.result === "success") {
                alert("아이디는: " + response.id);
            } else {
                alert("정보를 찾을 수 없습니다.");
            }
        },
        error: function() {
            alert("서버 오류. 다시 시도해주세요.");
        }
    });
}

// 비밀번호 찾기 함수
function handleFindPw() {
    const name = $("#name").val();
    const email = $("#email").val();
    const verificationCode = $("#repeat__password").val();

    $.ajax({
        url: "/member/resetPassword/",
        type: "POST",
        headers: { "X-CSRFToken": csrfToken },
        data: { name, email, verification_code: verificationCode },
        success: function(response) {
            if (response.result === "success") {
                alert("새 비밀번호가 이메일로 전송되었습니다.");
            } else {
                alert("인증 실패. 다시 시도해주세요.");
            }
        },
        error: function() {
            alert("서버 오류. 다시 시도해주세요.");
        }
    });
}
